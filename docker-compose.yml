version: '3.7'
services:
  sensor-1:
    image: sensor:latest
    restart: on-failure
    build:
      context: .
      dockerfile: sensorfile
    environment:
      - 'ip=centralStation'
      - 'port=51020'
      - 'sensortype=Fuel_Level'
  sensor-2:
    image: sensor:latest
    restart: on-failure
    environment:
      - 'ip=centralStation'
      - 'port=51021'
      - 'sensortype=TravelDistance'
  sensor-3:
    image: sensor:latest
    restart: on-failure
    environment:
      - 'ip=centralStation'
      - 'port=51022'
      - 'sensortype=TrafficState'
  sensor-4:
    image: sensor:latest
    restart: on-failure
    environment:
      - 'ip=centralStation'
      - 'port=51023'
      - 'sensortype=AvgSpeed'
  sensor-5:
    image: sensor:latest
    restart: on-failure
    environment:
      - 'ip=centralStation'
      - 'port=51024'
      - 'sensortype=AvgSpeed'
  centralstation:
    build:
      context: .
      dockerfile: centralfile
    environment:
      - 'stationname=Group_e9_Station'
      - 'sensorcount=5'
      - 'sensorstartport=51020'
    ports:
      - 8080:8080
      - 51030:51030
  serviceprovider:
    image: rpc
    restart: on-failure
    build:
      context: .
      dockerfile: serviceproviderfile
    environment:
      - 'ip=centralstation'
      - 'port=56565'
    ports:
      - 9091:9091
  mosquitto:
    image: "eclipse-mosquitto"
    container_name: "mosquitto"
    ports:
      - 1883:1883
      - 9001:9001
    volumes:
      - "./mosquitto.conf:/mosquitto/config/mosquitto.conf"
  mongo:
    image: mongo:latest
    volumes:
      - "./mongo-data:/data/db"
  mongo-client:
    image: mongo-express:latest
    restart: on-failure
    ports:
      - 8081:8081
    depends_on:
      - mongo